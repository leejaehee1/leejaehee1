블로그 서비스도 **Serverless**로 충분히 만들 수 있습니다.
API Gateway + Lambda + DynamoDB + S3 조합으로 “간단한 블로그 서비스”를 구현하는 예제를 알려드릴게요.

---

# 📝 Serverless 블로그 서비스 예제

## 📌 아키텍처 개요

* **API Gateway**: REST API 엔드포인트 (게시글 CRUD 요청 처리)
* **Lambda**: 게시글 작성/조회/수정/삭제 로직 실행
* **DynamoDB**: 게시글 메타데이터 저장 (제목, 내용, 작성자, 날짜 등)
* **S3**: 이미지/첨부 파일 저장소
* **CloudFront**(선택): 정적 페이지(리액트 프론트엔드) 배포

---

## 📂 DynamoDB 테이블 예시

```json
{
  "TableName": "BlogPosts",
  "KeySchema": [
    { "AttributeName": "postId", "KeyType": "HASH" }
  ],
  "AttributeDefinitions": [
    { "AttributeName": "postId", "AttributeType": "S" }
  ],
  "ProvisionedThroughput": {
    "ReadCapacityUnits": 5,
    "WriteCapacityUnits": 5
  }
}
```

---

## ⚡ Lambda 함수 예제 (Node.js)

### 1. 게시글 작성 (Create)

```js
const { v4: uuidv4 } = require("uuid");
const AWS = require("aws-sdk");
const dynamoDb = new AWS.DynamoDB.DocumentClient();

exports.handler = async (event) => {
  const data = JSON.parse(event.body);
  const postId = uuidv4();

  const params = {
    TableName: "BlogPosts",
    Item: {
      postId,
      title: data.title,
      content: data.content,
      author: data.author,
      createdAt: new Date().toISOString()
    },
  };

  await dynamoDb.put(params).promise();

  return {
    statusCode: 201,
    body: JSON.stringify({ message: "Post created", postId }),
  };
};
```

---

### 2. 게시글 조회 (Read)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  const result = await dynamoDb.get(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Item),
  };
};
```

---

### 3. 게시글 목록 (List)

```js
exports.handler = async () => {
  const params = {
    TableName: "BlogPosts",
    Limit: 20, // 페이지네이션
  };

  const result = await dynamoDb.scan(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Items),
  };
};
```

---

### 4. 게시글 수정 (Update)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;
  const data = JSON.parse(event.body);

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
    UpdateExpression: "set title = :t, content = :c",
    ExpressionAttributeValues: {
      ":t": data.title,
      ":c": data.content,
    },
    ReturnValues: "UPDATED_NEW",
  };

  const result = await dynamoDb.update(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Attributes),
  };
};
```

---

### 5. 게시글 삭제 (Delete)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  await dynamoDb.delete(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post deleted" }),
  };
};
```

---

## 🚀 Serverless Framework 설정 (serverless.yml)

```yaml
service: blog-service

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2

functions:
  createPost:
    handler: create.handler
    events:
      - http:
          path: posts
          method: post
  getPost:
    handler: get.handler
    events:
      - http:
          path: posts/{id}
          method: get
  listPosts:
    handler: list.handler
    events:
      - http:
          path: posts
          method: get
  updatePost:
    handler: update.handler
    events:
      - http:
          path: posts/{id}
          method: put
  deletePost:
    handler: delete.handler
    events:
      - http:
          path: posts/{id}
          method: delete

resources:
  Resources:
    BlogPostsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: BlogPosts
        AttributeDefinitions:
          - AttributeName: postId
            AttributeType: S
        KeySchema:
          - AttributeName: postId
            KeyType: HASH
        BillingMode: PAY_PER_REQUEST
```

---

## 🌐 프론트엔드 연동

* **React/Next.js** 정적 블로그 UI 작성
* **Axios / fetch** 로 API Gateway 호출
* **S3/CloudFront**로 정적 페이지 호스팅

그럼 **텍스트 기반 블로그 API**만 다루는 **Serverless 예제**를 정리해드릴게요.

---

# 📝 텍스트 기반 블로그 API (Serverless)

## 📌 아키텍처

* **API Gateway** → REST 엔드포인트 제공
* **Lambda (Node.js)** → 게시글 CRUD 처리
* **DynamoDB** → 게시글 저장소 (제목, 본문, 작성자, 생성일 등)

👉 S3, CloudFront 같은 파일 스토리지는 생략하고 **텍스트 데이터만** 다룹니다.

---

## 📂 DynamoDB 테이블 구조

* 테이블명: `BlogPosts`
* 파티션 키: `postId (String)`

예시 데이터:

```json
{
  "postId": "1234-5678",
  "title": "첫 번째 글",
  "content": "안녕하세요! 서버리스 블로그입니다.",
  "author": "jaehee",
  "createdAt": "2025-08-25T12:00:00Z"
}
```

---

## ⚡ Lambda 함수 예제

### 1. 게시글 작성 (Create)

```js
const { v4: uuidv4 } = require("uuid");
const AWS = require("aws-sdk");
const dynamoDb = new AWS.DynamoDB.DocumentClient();

exports.handler = async (event) => {
  const data = JSON.parse(event.body);
  const postId = uuidv4();

  const params = {
    TableName: "BlogPosts",
    Item: {
      postId,
      title: data.title,
      content: data.content,
      author: data.author,
      createdAt: new Date().toISOString(),
    },
  };

  await dynamoDb.put(params).promise();

  return {
    statusCode: 201,
    body: JSON.stringify({ message: "Post created", postId }),
  };
};
```

---

### 2. 게시글 조회 (Read)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  const result = await dynamoDb.get(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Item || {}),
  };
};
```

---

### 3. 게시글 목록 (List)

```js
exports.handler = async () => {
  const params = { TableName: "BlogPosts" };
  const result = await dynamoDb.scan(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Items),
  };
};
```

---

### 4. 게시글 수정 (Update)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;
  const data = JSON.parse(event.body);

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
    UpdateExpression: "set title = :t, content = :c",
    ExpressionAttributeValues: {
      ":t": data.title,
      ":c": data.content,
    },
    ReturnValues: "UPDATED_NEW",
  };

  const result = await dynamoDb.update(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Attributes),
  };
};
```

---

### 5. 게시글 삭제 (Delete)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  await dynamoDb.delete(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post deleted" }),
  };
};
```

---

## 🚀 serverless.yml 설정

```yaml
service: text-blog-service

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2

functions:
  createPost:
    handler: create.handler
    events:
      - http:
          path: posts
          method: post
  getPost:
    handler: get.handler
    events:
      - http:
          path: posts/{id}
          method: get
  listPosts:
    handler: list.handler
    events:
      - http:
          path: posts
          method: get
  updatePost:
    handler: update.handler
    events:
      - http:
          path: posts/{id}
          method: put
  deletePost:
    handler: delete.handler
    events:
      - http:
          path: posts/{id}
          method: delete

resources:
  Resources:
    BlogPostsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: BlogPosts
        AttributeDefinitions:
          - AttributeName: postId
            AttributeType: S
        KeySchema:
          - AttributeName: postId
            KeyType: HASH
        BillingMode: PAY_PER_REQUEST
```

---

# 📝 Serverless + MySQL 연동

## 📌 아키텍처

* **API Gateway** → REST API 엔드포인트 제공
* **Lambda (Node.js)** → MySQL 연결 후 쿼리 실행
* **RDS(MySQL)** → 게시글 저장 (title, content, author 등)

---

## ⚡ Lambda 예제 코드 (Node.js)

### 1. MySQL 연결

```js
const mysql = require("mysql2/promise");

let connection;

async function connectToDB() {
  if (!connection) {
    connection = await mysql.createConnection({
      host: process.env.DB_HOST,
      user: process.env.DB_USER,
      password: process.env.DB_PASSWORD,
      database: process.env.DB_NAME,
    });
  }
  return connection;
}
```

---

### 2. 게시글 작성 (Create)

```js
exports.createPost = async (event) => {
  const db = await connectToDB();
  const data = JSON.parse(event.body);

  const [result] = await db.execute(
    "INSERT INTO posts (title, content, author, createdAt) VALUES (?, ?, ?, NOW())",
    [data.title, data.content, data.author]
  );

  return {
    statusCode: 201,
    body: JSON.stringify({ message: "Post created", id: result.insertId }),
  };
};
```

---

### 3. 게시글 조회 (Read)

```js
exports.getPost = async (event) => {
  const db = await connectToDB();
  const id = event.pathParameters.id;

  const [rows] = await db.execute("SELECT * FROM posts WHERE id = ?", [id]);

  return {
    statusCode: 200,
    body: JSON.stringify(rows[0] || {}),
  };
};
```

---

### 4. 게시글 목록 (List)

```js
exports.listPosts = async () => {
  const db = await connectToDB();
  const [rows] = await db.execute("SELECT * FROM posts ORDER BY createdAt DESC");

  return {
    statusCode: 200,
    body: JSON.stringify(rows),
  };
};
```

---

### 5. 게시글 수정 (Update)

```js
exports.updatePost = async (event) => {
  const db = await connectToDB();
  const id = event.pathParameters.id;
  const data = JSON.parse(event.body);

  await db.execute(
    "UPDATE posts SET title = ?, content = ? WHERE id = ?",
    [data.title, data.content, id]
  );

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post updated" }),
  };
};
```

---

### 6. 게시글 삭제 (Delete)

```js
exports.deletePost = async (event) => {
  const db = await connectToDB();
  const id = event.pathParameters.id;

  await db.execute("DELETE FROM posts WHERE id = ?", [id]);

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post deleted" }),
  };
};
```

---

## 🚀 serverless.yml 예제

```yaml
service: mysql-blog-service

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2
  environment:
    DB_HOST: mydb.xxxxx.ap-northeast-2.rds.amazonaws.com
    DB_USER: admin
    DB_PASSWORD: password123
    DB_NAME: blogdb

functions:
  createPost:
    handler: handler.createPost
    events:
      - http:
          path: posts
          method: post
  getPost:
    handler: handler.getPost
    events:
      - http:
          path: posts/{id}
          method: get
  listPosts:
    handler: handler.listPosts
    events:
      - http:
          path: posts
          method: get
  updatePost:
    handler: handler.updatePost
    events:
      - http:
          path: posts/{id}
          method: put
  deletePost:
    handler: handler.deletePost
    events:
      - http:
          path: posts/{id}
          method: delete
```

---

## ✅ 정리

* **DynamoDB 버전**은 완전 서버리스(NoSQL 기반)
* **MySQL 버전**은 RDS 인스턴스를 사용 (운영비 발생, 커넥션 풀 관리 필요)
* Lambda에서는 `mysql2/promise` 모듈로 연결 → **Cold Start 시 커넥션** 문제 주의

👉 실습에서는 **DynamoDB로 먼저 블로그 API**를 만들고,
추가 심화로 **MySQL 연동 버전**을 보여주면 학습자들이 차이를 명확히 이해할 수 있습니다.
