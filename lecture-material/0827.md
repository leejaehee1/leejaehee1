ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤ë„ **Serverless**ë¡œ ì¶©ë¶„íˆ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
API Gateway + Lambda + DynamoDB + S3 ì¡°í•©ìœ¼ë¡œ â€œê°„ë‹¨í•œ ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤â€ë¥¼ êµ¬í˜„í•˜ëŠ” ì˜ˆì œë¥¼ ì•Œë ¤ë“œë¦´ê²Œìš”.

---

# ğŸ“ Serverless ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤ ì˜ˆì œ

## ğŸ“Œ ì•„í‚¤í…ì²˜ ê°œìš”

* **API Gateway**: REST API ì—”ë“œí¬ì¸íŠ¸ (ê²Œì‹œê¸€ CRUD ìš”ì²­ ì²˜ë¦¬)
* **Lambda**: ê²Œì‹œê¸€ ì‘ì„±/ì¡°íšŒ/ìˆ˜ì •/ì‚­ì œ ë¡œì§ ì‹¤í–‰
* **DynamoDB**: ê²Œì‹œê¸€ ë©”íƒ€ë°ì´í„° ì €ì¥ (ì œëª©, ë‚´ìš©, ì‘ì„±ì, ë‚ ì§œ ë“±)
* **S3**: ì´ë¯¸ì§€/ì²¨ë¶€ íŒŒì¼ ì €ì¥ì†Œ
* **CloudFront**(ì„ íƒ): ì •ì  í˜ì´ì§€(ë¦¬ì•¡íŠ¸ í”„ë¡ íŠ¸ì—”ë“œ) ë°°í¬

---

## ğŸ“‚ DynamoDB í…Œì´ë¸” ì˜ˆì‹œ

```json
{
  "TableName": "BlogPosts",
  "KeySchema": [
    { "AttributeName": "postId", "KeyType": "HASH" }
  ],
  "AttributeDefinitions": [
    { "AttributeName": "postId", "AttributeType": "S" }
  ],
  "ProvisionedThroughput": {
    "ReadCapacityUnits": 5,
    "WriteCapacityUnits": 5
  }
}
```

---

## âš¡ Lambda í•¨ìˆ˜ ì˜ˆì œ (Node.js)

### 1. ê²Œì‹œê¸€ ì‘ì„± (Create)

```js
const { v4: uuidv4 } = require("uuid");
const AWS = require("aws-sdk");
const dynamoDb = new AWS.DynamoDB.DocumentClient();

exports.handler = async (event) => {
  const data = JSON.parse(event.body);
  const postId = uuidv4();

  const params = {
    TableName: "BlogPosts",
    Item: {
      postId,
      title: data.title,
      content: data.content,
      author: data.author,
      createdAt: new Date().toISOString()
    },
  };

  await dynamoDb.put(params).promise();

  return {
    statusCode: 201,
    body: JSON.stringify({ message: "Post created", postId }),
  };
};
```

---

### 2. ê²Œì‹œê¸€ ì¡°íšŒ (Read)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  const result = await dynamoDb.get(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Item),
  };
};
```

---

### 3. ê²Œì‹œê¸€ ëª©ë¡ (List)

```js
exports.handler = async () => {
  const params = {
    TableName: "BlogPosts",
    Limit: 20, // í˜ì´ì§€ë„¤ì´ì…˜
  };

  const result = await dynamoDb.scan(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Items),
  };
};
```

---

### 4. ê²Œì‹œê¸€ ìˆ˜ì • (Update)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;
  const data = JSON.parse(event.body);

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
    UpdateExpression: "set title = :t, content = :c",
    ExpressionAttributeValues: {
      ":t": data.title,
      ":c": data.content,
    },
    ReturnValues: "UPDATED_NEW",
  };

  const result = await dynamoDb.update(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Attributes),
  };
};
```

---

### 5. ê²Œì‹œê¸€ ì‚­ì œ (Delete)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  await dynamoDb.delete(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post deleted" }),
  };
};
```

---

## ğŸš€ Serverless Framework ì„¤ì • (serverless.yml)

```yaml
service: blog-service

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2

functions:
  createPost:
    handler: create.handler
    events:
      - http:
          path: posts
          method: post
  getPost:
    handler: get.handler
    events:
      - http:
          path: posts/{id}
          method: get
  listPosts:
    handler: list.handler
    events:
      - http:
          path: posts
          method: get
  updatePost:
    handler: update.handler
    events:
      - http:
          path: posts/{id}
          method: put
  deletePost:
    handler: delete.handler
    events:
      - http:
          path: posts/{id}
          method: delete

resources:
  Resources:
    BlogPostsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: BlogPosts
        AttributeDefinitions:
          - AttributeName: postId
            AttributeType: S
        KeySchema:
          - AttributeName: postId
            KeyType: HASH
        BillingMode: PAY_PER_REQUEST
```

---

## ğŸŒ í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™

* **React/Next.js** ì •ì  ë¸”ë¡œê·¸ UI ì‘ì„±
* **Axios / fetch** ë¡œ API Gateway í˜¸ì¶œ
* **S3/CloudFront**ë¡œ ì •ì  í˜ì´ì§€ í˜¸ìŠ¤íŒ…

ê·¸ëŸ¼ **í…ìŠ¤íŠ¸ ê¸°ë°˜ ë¸”ë¡œê·¸ API**ë§Œ ë‹¤ë£¨ëŠ” **Serverless ì˜ˆì œ**ë¥¼ ì •ë¦¬í•´ë“œë¦´ê²Œìš”.

---

# ğŸ“ í…ìŠ¤íŠ¸ ê¸°ë°˜ ë¸”ë¡œê·¸ API (Serverless)

## ğŸ“Œ ì•„í‚¤í…ì²˜

* **API Gateway** â†’ REST ì—”ë“œí¬ì¸íŠ¸ ì œê³µ
* **Lambda (Node.js)** â†’ ê²Œì‹œê¸€ CRUD ì²˜ë¦¬
* **DynamoDB** â†’ ê²Œì‹œê¸€ ì €ì¥ì†Œ (ì œëª©, ë³¸ë¬¸, ì‘ì„±ì, ìƒì„±ì¼ ë“±)

ğŸ‘‰ S3, CloudFront ê°™ì€ íŒŒì¼ ìŠ¤í† ë¦¬ì§€ëŠ” ìƒëµí•˜ê³  **í…ìŠ¤íŠ¸ ë°ì´í„°ë§Œ** ë‹¤ë£¹ë‹ˆë‹¤.

---

## ğŸ“‚ DynamoDB í…Œì´ë¸” êµ¬ì¡°

* í…Œì´ë¸”ëª…: `BlogPosts`
* íŒŒí‹°ì…˜ í‚¤: `postId (String)`

ì˜ˆì‹œ ë°ì´í„°:

```json
{
  "postId": "1234-5678",
  "title": "ì²« ë²ˆì§¸ ê¸€",
  "content": "ì•ˆë…•í•˜ì„¸ìš”! ì„œë²„ë¦¬ìŠ¤ ë¸”ë¡œê·¸ì…ë‹ˆë‹¤.",
  "author": "jaehee",
  "createdAt": "2025-08-25T12:00:00Z"
}
```

---

## âš¡ Lambda í•¨ìˆ˜ ì˜ˆì œ

### 1. ê²Œì‹œê¸€ ì‘ì„± (Create)

```js
const { v4: uuidv4 } = require("uuid");
const AWS = require("aws-sdk");
const dynamoDb = new AWS.DynamoDB.DocumentClient();

exports.handler = async (event) => {
  const data = JSON.parse(event.body);
  const postId = uuidv4();

  const params = {
    TableName: "BlogPosts",
    Item: {
      postId,
      title: data.title,
      content: data.content,
      author: data.author,
      createdAt: new Date().toISOString(),
    },
  };

  await dynamoDb.put(params).promise();

  return {
    statusCode: 201,
    body: JSON.stringify({ message: "Post created", postId }),
  };
};
```

---

### 2. ê²Œì‹œê¸€ ì¡°íšŒ (Read)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  const result = await dynamoDb.get(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Item || {}),
  };
};
```

---

### 3. ê²Œì‹œê¸€ ëª©ë¡ (List)

```js
exports.handler = async () => {
  const params = { TableName: "BlogPosts" };
  const result = await dynamoDb.scan(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Items),
  };
};
```

---

### 4. ê²Œì‹œê¸€ ìˆ˜ì • (Update)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;
  const data = JSON.parse(event.body);

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
    UpdateExpression: "set title = :t, content = :c",
    ExpressionAttributeValues: {
      ":t": data.title,
      ":c": data.content,
    },
    ReturnValues: "UPDATED_NEW",
  };

  const result = await dynamoDb.update(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify(result.Attributes),
  };
};
```

---

### 5. ê²Œì‹œê¸€ ì‚­ì œ (Delete)

```js
exports.handler = async (event) => {
  const postId = event.pathParameters.id;

  const params = {
    TableName: "BlogPosts",
    Key: { postId },
  };

  await dynamoDb.delete(params).promise();

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post deleted" }),
  };
};
```

---

## ğŸš€ serverless.yml ì„¤ì •

```yaml
service: text-blog-service

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2

functions:
  createPost:
    handler: create.handler
    events:
      - http:
          path: posts
          method: post
  getPost:
    handler: get.handler
    events:
      - http:
          path: posts/{id}
          method: get
  listPosts:
    handler: list.handler
    events:
      - http:
          path: posts
          method: get
  updatePost:
    handler: update.handler
    events:
      - http:
          path: posts/{id}
          method: put
  deletePost:
    handler: delete.handler
    events:
      - http:
          path: posts/{id}
          method: delete

resources:
  Resources:
    BlogPostsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: BlogPosts
        AttributeDefinitions:
          - AttributeName: postId
            AttributeType: S
        KeySchema:
          - AttributeName: postId
            KeyType: HASH
        BillingMode: PAY_PER_REQUEST
```

---

# ğŸ“ Serverless + MySQL ì—°ë™

## ğŸ“Œ ì•„í‚¤í…ì²˜

* **API Gateway** â†’ REST API ì—”ë“œí¬ì¸íŠ¸ ì œê³µ
* **Lambda (Node.js)** â†’ MySQL ì—°ê²° í›„ ì¿¼ë¦¬ ì‹¤í–‰
* **RDS(MySQL)** â†’ ê²Œì‹œê¸€ ì €ì¥ (title, content, author ë“±)

---

## âš¡ Lambda ì˜ˆì œ ì½”ë“œ (Node.js)

### 1. MySQL ì—°ê²°

```js
const mysql = require("mysql2/promise");

let connection;

async function connectToDB() {
  if (!connection) {
    connection = await mysql.createConnection({
      host: process.env.DB_HOST,
      user: process.env.DB_USER,
      password: process.env.DB_PASSWORD,
      database: process.env.DB_NAME,
    });
  }
  return connection;
}
```

---

### 2. ê²Œì‹œê¸€ ì‘ì„± (Create)

```js
exports.createPost = async (event) => {
  const db = await connectToDB();
  const data = JSON.parse(event.body);

  const [result] = await db.execute(
    "INSERT INTO posts (title, content, author, createdAt) VALUES (?, ?, ?, NOW())",
    [data.title, data.content, data.author]
  );

  return {
    statusCode: 201,
    body: JSON.stringify({ message: "Post created", id: result.insertId }),
  };
};
```

---

### 3. ê²Œì‹œê¸€ ì¡°íšŒ (Read)

```js
exports.getPost = async (event) => {
  const db = await connectToDB();
  const id = event.pathParameters.id;

  const [rows] = await db.execute("SELECT * FROM posts WHERE id = ?", [id]);

  return {
    statusCode: 200,
    body: JSON.stringify(rows[0] || {}),
  };
};
```

---

### 4. ê²Œì‹œê¸€ ëª©ë¡ (List)

```js
exports.listPosts = async () => {
  const db = await connectToDB();
  const [rows] = await db.execute("SELECT * FROM posts ORDER BY createdAt DESC");

  return {
    statusCode: 200,
    body: JSON.stringify(rows),
  };
};
```

---

### 5. ê²Œì‹œê¸€ ìˆ˜ì • (Update)

```js
exports.updatePost = async (event) => {
  const db = await connectToDB();
  const id = event.pathParameters.id;
  const data = JSON.parse(event.body);

  await db.execute(
    "UPDATE posts SET title = ?, content = ? WHERE id = ?",
    [data.title, data.content, id]
  );

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post updated" }),
  };
};
```

---

### 6. ê²Œì‹œê¸€ ì‚­ì œ (Delete)

```js
exports.deletePost = async (event) => {
  const db = await connectToDB();
  const id = event.pathParameters.id;

  await db.execute("DELETE FROM posts WHERE id = ?", [id]);

  return {
    statusCode: 200,
    body: JSON.stringify({ message: "Post deleted" }),
  };
};
```

---

## ğŸš€ serverless.yml ì˜ˆì œ

```yaml
service: mysql-blog-service

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2
  environment:
    DB_HOST: mydb.xxxxx.ap-northeast-2.rds.amazonaws.com
    DB_USER: admin
    DB_PASSWORD: password123
    DB_NAME: blogdb

functions:
  createPost:
    handler: handler.createPost
    events:
      - http:
          path: posts
          method: post
  getPost:
    handler: handler.getPost
    events:
      - http:
          path: posts/{id}
          method: get
  listPosts:
    handler: handler.listPosts
    events:
      - http:
          path: posts
          method: get
  updatePost:
    handler: handler.updatePost
    events:
      - http:
          path: posts/{id}
          method: put
  deletePost:
    handler: handler.deletePost
    events:
      - http:
          path: posts/{id}
          method: delete
```

---

## âœ… ì •ë¦¬

* **DynamoDB ë²„ì „**ì€ ì™„ì „ ì„œë²„ë¦¬ìŠ¤(NoSQL ê¸°ë°˜)
* **MySQL ë²„ì „**ì€ RDS ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš© (ìš´ì˜ë¹„ ë°œìƒ, ì»¤ë„¥ì…˜ í’€ ê´€ë¦¬ í•„ìš”)
* Lambdaì—ì„œëŠ” `mysql2/promise` ëª¨ë“ˆë¡œ ì—°ê²° â†’ **Cold Start ì‹œ ì»¤ë„¥ì…˜** ë¬¸ì œ ì£¼ì˜

ğŸ‘‰ ì‹¤ìŠµì—ì„œëŠ” **DynamoDBë¡œ ë¨¼ì € ë¸”ë¡œê·¸ API**ë¥¼ ë§Œë“¤ê³ ,
ì¶”ê°€ ì‹¬í™”ë¡œ **MySQL ì—°ë™ ë²„ì „**ì„ ë³´ì—¬ì£¼ë©´ í•™ìŠµìë“¤ì´ ì°¨ì´ë¥¼ ëª…í™•íˆ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
